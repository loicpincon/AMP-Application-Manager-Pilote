<div class="container" *ngIf="formulaire">
    <div class="title">
        <h1>Configurer l'application</h1>
    </div>
    <form fxLayout="column" *ngIf="application" [formGroup]="formulaire" (ngSubmit)="onSubmit(formulaire.value)">
        <div fxLayout="row">
            <div fxLayout="column" fxFlex="50%">
                <div class="colonne">
                    <mat-form-field class="fullSize">
                        <input required formControlName="name" matInput placeholder="Nom application">
                    </mat-form-field>
                </div>
                <div class="colonne">
                    <mat-form-field class="fullSize">
                        <input required formControlName="basename" matInput placeholder="Base name">
                    </mat-form-field>
                </div>
                <div class="colonne">
                    <mat-form-field class="fullSize">
                        <input required formControlName="urlJenkins" matInput placeholder="URL job jenkins">
                    </mat-form-field>
                </div>
                <div fxLayout="column" class="colonne">
                    <div class="fullSize">
                        <mat-form-field fxFlex="50%">
                            <mat-label>Type application</mat-label>
                            <mat-select disabled matTooltip="Vous ne pouvez plus changer le type de l'application"
                                (selectionChange)="selectType($event.value)" required formControlName="typeApp"
                                [(value)]="formulaire.value.typeApp">
                                <mat-option *ngFor="let type of typeApplication" [value]="type">
                                    {{type}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                        <div fxFlex="50%" *ngIf="formulaire.value.typeApp">
                            <div formGroupName="angularApplication" *ngIf="formulaire.value.typeApp=='ANGULAR'">
                                <mat-form-field class="inputTypeApp">
                                    <input required formControlName="versionAngular" matInput
                                        placeholder="Version Angular">
                                </mat-form-field>

                                <mat-form-field class="inputTypeApp">

                                    <input required formControlName="isBuilder" matInput
                                        placeholder="L'application est elle build">
                                </mat-form-field>
                                <mat-form-field class="inputTypeApp">

                                    <input required formControlName="baseLocation" matInput
                                        placeholder="Emplacement des sources">
                                </mat-form-field>
                                <mat-form-field class="inputTypeApp">

                                    <input required formControlName="userProprietaire" matInput
                                        placeholder="Utilisateur proprietaire">
                                </mat-form-field>
                                <mat-form-field class="inputTypeApp">

                                    <input required formControlName="nomRepository" matInput
                                        placeholder="Nom repository">
                                </mat-form-field>
                            </div>
                            <div formGroupName="nodeJsApplication" *ngIf="formulaire.value.typeApp=='NODEJS'">

                            </div>
                            <div formGroupName="warApplication" *ngIf="formulaire.value.typeApp=='WAR'">
                                <mat-form-field class="inputTypeApp">
                                    <input required formControlName="nomFichierProperties" matInput
                                        placeholder="Nom fichier Properties">
                                </mat-form-field>
                            </div>
                            <div formGroupName="bashApplication" *ngIf="formulaire.value.typeApp=='BASH'">
                                <mat-form-field class="inputTypeApp">
                                    <input required matInput formControlName="urlBatch" placeholder="URL Batch">
                                </mat-form-field>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div fxLayout="column" fxFlex="50%">
                <p>Liste des environnements</p>
                <div class="env" *ngFor="let env of allServer">
                    <button (click)="switchEtatEnv(env,false)" type="button" *ngIf="env.id==1 && env.etat"
                        mat-raised-button>Développement - Activé</button>
                    <button (click)="switchEtatEnv(env,false)" type="button" *ngIf="env.id==2 && env.etat"
                        mat-raised-button>Recette Utilisateurs - Activé</button>
                    <button (click)="switchEtatEnv(env,false)" type="button" *ngIf="env.id==3 && env.etat"
                        mat-raised-button>Production - Activé</button>
                    <button (click)="switchEtatEnv(env,true)" type="button" class="btnDesactive"
                        *ngIf="env.id==1 && !env.etat" mat-raised-button>Développement - Désactivé</button>
                    <button (click)="switchEtatEnv(env,true)" type="button" class="btnDesactive"
                        *ngIf="env.id==2 && !env.etat" mat-raised-button>Recette Utilisateurs - Désactivé</button>
                    <button (click)="switchEtatEnv(env,true)" type="button" class="btnDesactive"
                        *ngIf="env.id==3 && !env.etat" mat-raised-button>Production - Désactivé</button>
                </div>
            </div>
        </div>
        <div class="colonne">
            <mat-form-field class="fullSize">
                <textarea style="width: 100%;" formControlName="dockerfilesText" cdkTextareaAutosize
                    #autosize="cdkTextareaAutosize" cdkAutosizeMinRows="5" [(value)]="formulaire.value.dockerfilesText"
                    matInput></textarea>
            </mat-form-field>
        </div>
        <div>
            <button mat-raised-button color="primary" type="submit">Modifier</button>
        </div>
    </form>
</div>